(()=>{"use strict";window.addEventListener("DOMContentLoaded",()=>{(function(){let e=[],t=[],a=[];const n=document.querySelector("#opentasks ul"),s=document.querySelector("#closedtasks ul"),d=document.querySelector("#noopentasks"),i=e=>{const t=e.dataset.id,a=e.value;t?a.length>0?u(e.value,t):h(t):(c(e.value),e.value="")},r=(e,t)=>{const a=`\n                <li>\n                    <div>\n                        <input type="checkbox" data-id="${t.id}" ${t.done?"checked":""}>\n                    </div>\n                    <div class="grow">\n                        <textarea rows="1" data-id="${t.id}">${t.task}</textarea>\n                    </div>\n                    <div>\n                        <a href="#" data-id="${t.id}" class="delete"><i data-lucide="x"></i></a>\n                    </div>\n                </li>`;e.insertAdjacentHTML("beforeend",a)},c=t=>{console.log(e),e.push({id:Date.now(),task:t,done:!1}),v()},o=t=>e.findIndex(e=>e.id===Number(t)),l=()=>{e=JSON.parse(localStorage.getItem("tasks"))||[],n.innerHTML="",s.innerHTML="",e&&e.length>0?(t=e.filter(e=>!e.done),a=e.filter(e=>e.done),t.length>0?(d.classList.add("hidden"),t.forEach(e=>r(n,e))):d.classList.remove("hidden"),a.length>0&&a.forEach(e=>r(s,e))):d.classList.remove("hidden"),lucide.createIcons()},u=(t,a)=>{const n=o(a);n<0||(e[n].task=t,v())},g=t=>{const a=o(t);a<0||(e[a].done=!e[a].done,v())},h=t=>{const a=o(t);a<0||(e.splice(a,1),v())},v=()=>{try{localStorage.setItem("tasks",JSON.stringify(e))}catch(e){alert("Sorry, data storage failed: "+e.message)}l()};document.addEventListener("click",e=>{const t=e.target.closest("a");t?t.matches(".delete")&&h(t.dataset.id):e.target.matches("input[type=checkbox]")&&g(e.target.dataset.id)}),document.addEventListener("keydown",e=>{if(e.target.matches("textarea")&&"Enter"===e.key)if(e.preventDefault(),e.ctrlKey||e.metaKey){const t=e.target.selectionStart,a=e.target.selectionEnd,n=e.target.value;e.target.value=n.substring(0,t)+"\n"+n.substring(a)}else i(e.target)}),l()})(),document.addEventListener("input",e=>{var t;e.target.matches("textarea")&&((t=e.target).style.height="auto",t.style.height=t.scrollHeight+"px")}),lucide.createIcons()})})();